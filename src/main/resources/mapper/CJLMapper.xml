<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jcww.training.mapper.CJLMapper">

    <!--List<Question> MyQuestionBank();-->
    <select id="MyQuestionBank" resultType="com.jcww.training.pojo.Question">
        SELECT
        qt.questionid,
        qt.questionname,
        qucla.questionclassifyname,
        CASE qt.questiontype
        WHEN '1' THEN '单选'
        WHEN '2' THEN '多选'
        WHEN '3' THEN '判断'
        WHEN '4' THEN '填空'
        WHEN '5' THEN '简答'
        ELSE 'Error' END AS questiontype,
        qt.answer,
        qt.score,
        qt.createtime
        FROM question qt
        LEFT JOIN questionclassify AS qucla ON qucla.questionclassifyid = qt.questionclassifyid
        ORDER BY qt.createtime DESC
        <if test="questiontype!=null and questiontype!=''">
            WHERE qt.questiontype = #{questiontype}
        </if>
    </select>

    <!--int DaoRu(@Param("li") List<Question> li);-->
    <insert id="DaoRu">
        insert into question
        (questionid,questionname,answer,score,resolve,optiona,optionb,optionc,optiond,isnotshare,createtime,questionclassifyid,questiontype,createusername,ownuser)
        values
        <foreach collection="li" item="li" separator=",">
            (null,#{li.questionname},#{li.answer},#{li.score},#{li.resolve},#{li.optiona},#{li.optionb},#{li.optionc},#{li.optiond},#{li.isnotshare},#{li.createtime},#{li.questionclassifyid},#{li.questiontype},#{li.createusername},#{li.ownuser})
        </foreach>
    </insert>

    <!--int danxuanAdd(Question question);-->
    <insert id="danxuanAdd">
        insert into question
        (questionid, questionname, questiontype, questionclassifyid, optiona, optionb, optionc, optiond, answer, score,
         createtime)
        values (null, #{questionname}, #{questiontype}, #{questionclassifyid}, #{optiona}, #{optionb}, #{optionc},
                #{optiond}, #{answer}, #{score}, #{createtime})
    </insert>

    <!--int perDel(@Param("questionid") Integer questionid);-->
    <delete id="perDel">
        DELETE qap,que
            FROM question que
        LEFT JOIN questionandpaper qap
            ON que.questionid = qap.questionid
        WHERE que.questionid = #{questionid}
    </delete>

    <!--Question ViewID(@Param("questionid") Integer questionid);-->
    <select id="ViewID" resultType="com.jcww.training.pojo.Question">
        SELECT qt.questionid,
               qt.questionname,
               qucla.questionclassifyid,
               qt.questiontype,
               qt.answer,
               qt.score,
               qt.createtime,
               qt.optiona,
               qt.optionb,
               qt.optionc,
               qt.optiond
        FROM question qt
                 LEFT JOIN questionclassify AS qucla ON qucla.questionclassifyid = qt.questionclassifyid
        where qt.questionid = #{questionid}
    </select>

    <!--int preup(Question question);-->
    <update id="preup">
        update question set
        questionname=#{questionname},
        answer=#{answer},
        score=#{score},
        optiona=#{optiona},
        optionb=#{optionb},
        optionc=#{optionc},
        optiond=#{optiond},
        questionclassifyid=#{questionclassifyid},
        questiontype=#{questiontype}
        <where>
            <if test="questionid!=null and questionid!=0">
                questionid=#{questionid}
            </if>
        </where>
    </update>
</mapper>